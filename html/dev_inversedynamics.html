

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inverse Dynamics &#8212; Kinetics Toolkit</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/stable.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Anthropometrics" href="dev_anthropometrics.html" />



    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Manual
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ktk_getting_started.html">
   Getting started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="python.html">
     Learning Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="python_installing.html">
       Installing Python and Spyder
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_using_spyder.html">
       Using Spyder
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_simple_operations.html">
       Simple operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_strings.html">
       Strings
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_comments_and_docstrings.html">
       Comments and docstrings
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_functions.html">
       Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_conditions.html">
       Conditions and booleans
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_lists.html">
       Lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_while.html">
       Looping (while)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_for.html">
       Looping (for)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_dicts.html">
       Dicts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_more_advanced.html">
       More advanced concepts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_integration_exercises.html">
       Integration exercises
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="python_external_tutorials.html">
       Links to external tutorials
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="numpy.html">
       Numpy basics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="matplotlib.html">
       Matplotlib basics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="pandas.html">
       Pandas basics
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ktk_installing.html">
     Installing Kinetics Toolkit
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tutorials.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="timeseries.html">
     TimeSeries
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="timeseries_basics.html">
       TimeSeries Basics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="timeseries_manipulating.html">
       Manipulating TimeSeries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="timeseries_dataframes.html">
       Converting between TimeSeries and Pandas DataFrames
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="loadsave.html">
     Saving and loading
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="filters.html">
     Filtering
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="filters_butter.html">
       Removing frequencies using a Butterworth filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="filters_smooth.html">
       Smoothing signals using a moving average
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="filters_savgol.html">
       Smoothing and deriving using a Savitzky-Golay filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="filters_median.html">
       Removing artefacts using a median filter
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cycles.html">
     Detecting and normalizing cycles
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="geometry.html">
     Rigid body geometry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="geometry_basics.html">
       Basics of rigid body geometry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="geometry_dimension_conventions.html">
       Dimension conventions and first example
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="kinematics.html">
     Kinematics analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="kinematics_load_visualize.html">
       Reading and visualizing marker trajectories
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="kinematics_joint_angles.html">
       Calculating joint angles from a kinematic acquisition
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="kinematics_reconstructing_occluded_markers.html">
       Reconstructing occluded markers
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="kinematics_reconstructing_removed_markers.html">
       Reconstructing removed markers
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="kinematics_reconstructing_probed_points.html">
       Reconstructing probed points
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pushrimkinetics.html">
     Wheelchair kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ktk_conventions.html">
     Conventions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ktk_in_depth.html">
   In depth
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ktk_lab_mode.html">
     Lab mode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ktk_release_notes.html">
     Release Notes
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api_classes.html">
   Classes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/kineticstoolkit.TimeSeries.html">
     kineticstoolkit.TimeSeries
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.add_data_info.html">
       kineticstoolkit.TimeSeries.add_data_info
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.add_event.html">
       kineticstoolkit.TimeSeries.add_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.copy.html">
       kineticstoolkit.TimeSeries.copy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.fill_missing_samples.html">
       kineticstoolkit.TimeSeries.fill_missing_samples
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.from_dataframe.html">
       kineticstoolkit.TimeSeries.from_dataframe
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_event_index.html">
       kineticstoolkit.TimeSeries.get_event_index
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_event_time.html">
       kineticstoolkit.TimeSeries.get_event_time
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_index_after_time.html">
       kineticstoolkit.TimeSeries.get_index_after_time
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_index_at_time.html">
       kineticstoolkit.TimeSeries.get_index_at_time
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_index_before_time.html">
       kineticstoolkit.TimeSeries.get_index_before_time
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_subset.html">
       kineticstoolkit.TimeSeries.get_subset
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_after_event.html">
       kineticstoolkit.TimeSeries.get_ts_after_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_after_index.html">
       kineticstoolkit.TimeSeries.get_ts_after_index
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_after_time.html">
       kineticstoolkit.TimeSeries.get_ts_after_time
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_at_event.html">
       kineticstoolkit.TimeSeries.get_ts_at_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_at_time.html">
       kineticstoolkit.TimeSeries.get_ts_at_time
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_before_event.html">
       kineticstoolkit.TimeSeries.get_ts_before_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_before_index.html">
       kineticstoolkit.TimeSeries.get_ts_before_index
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_before_time.html">
       kineticstoolkit.TimeSeries.get_ts_before_time
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_between_events.html">
       kineticstoolkit.TimeSeries.get_ts_between_events
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_between_indexes.html">
       kineticstoolkit.TimeSeries.get_ts_between_indexes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.get_ts_between_times.html">
       kineticstoolkit.TimeSeries.get_ts_between_times
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.isnan.html">
       kineticstoolkit.TimeSeries.isnan
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.merge.html">
       kineticstoolkit.TimeSeries.merge
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.plot.html">
       kineticstoolkit.TimeSeries.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.remove_data.html">
       kineticstoolkit.TimeSeries.remove_data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.remove_data_info.html">
       kineticstoolkit.TimeSeries.remove_data_info
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.remove_event.html">
       kineticstoolkit.TimeSeries.remove_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.rename_data.html">
       kineticstoolkit.TimeSeries.rename_data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.rename_event.html">
       kineticstoolkit.TimeSeries.rename_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.resample.html">
       kineticstoolkit.TimeSeries.resample
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.shift.html">
       kineticstoolkit.TimeSeries.shift
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.sort_events.html">
       kineticstoolkit.TimeSeries.sort_events
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.sync_event.html">
       kineticstoolkit.TimeSeries.sync_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.to_dataframe.html">
       kineticstoolkit.TimeSeries.to_dataframe
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.trim_events.html">
       kineticstoolkit.TimeSeries.trim_events
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.ui_add_event.html">
       kineticstoolkit.TimeSeries.ui_add_event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.ui_edit_events.html">
       kineticstoolkit.TimeSeries.ui_edit_events
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.ui_get_ts_between_clicks.html">
       kineticstoolkit.TimeSeries.ui_get_ts_between_clicks
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.TimeSeries.ui_sync.html">
       kineticstoolkit.TimeSeries.ui_sync
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/kineticstoolkit.TimeSeriesEvent.html">
     kineticstoolkit.TimeSeriesEvent
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/kineticstoolkit.Player.html">
     kineticstoolkit.Player
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.Player.close.html">
       kineticstoolkit.Player.close
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.Player.to_html5.html">
       kineticstoolkit.Player.to_html5
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api_functions.html">
   Functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="api/kineticstoolkit.load.html">
     kineticstoolkit.load
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/kineticstoolkit.save.html">
     kineticstoolkit.save
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api_modules.html">
   Modules
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/kineticstoolkit.cycles.html">
     kineticstoolkit.cycles
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.cycles.detect_cycles.html">
       kineticstoolkit.cycles.detect_cycles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.cycles.most_repeatable_cycles.html">
       kineticstoolkit.cycles.most_repeatable_cycles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.cycles.stack.html">
       kineticstoolkit.cycles.stack
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.cycles.time_normalize.html">
       kineticstoolkit.cycles.time_normalize
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.cycles.unstack.html">
       kineticstoolkit.cycles.unstack
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/kineticstoolkit.filters.html">
     kineticstoolkit.filters
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.filters.butter.html">
       kineticstoolkit.filters.butter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.filters.deriv.html">
       kineticstoolkit.filters.deriv
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.filters.median.html">
       kineticstoolkit.filters.median
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.filters.savgol.html">
       kineticstoolkit.filters.savgol
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.filters.smooth.html">
       kineticstoolkit.filters.smooth
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/kineticstoolkit.geometry.html">
     kineticstoolkit.geometry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.geometry.create_frames.html">
       kineticstoolkit.geometry.create_frames
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.geometry.create_transforms.html">
       kineticstoolkit.geometry.create_transforms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.geometry.get_angles.html">
       kineticstoolkit.geometry.get_angles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.geometry.get_global_coordinates.html">
       kineticstoolkit.geometry.get_global_coordinates
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.geometry.get_local_coordinates.html">
       kineticstoolkit.geometry.get_local_coordinates
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.geometry.matmul.html">
       kineticstoolkit.geometry.matmul
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.geometry.register_points.html">
       kineticstoolkit.geometry.register_points
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/kineticstoolkit.kinematics.html">
     kineticstoolkit.kinematics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.kinematics.create_cluster.html">
       kineticstoolkit.kinematics.create_cluster
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.kinematics.extend_cluster.html">
       kineticstoolkit.kinematics.extend_cluster
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.kinematics.read_c3d_file.html">
       kineticstoolkit.kinematics.read_c3d_file
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.kinematics.read_n3d_file.html">
       kineticstoolkit.kinematics.read_n3d_file
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.kinematics.track_cluster.html">
       kineticstoolkit.kinematics.track_cluster
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.kinematics.write_c3d_file.html">
       kineticstoolkit.kinematics.write_c3d_file
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/kineticstoolkit.pushrimkinetics.html">
     kineticstoolkit.pushrimkinetics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.pushrimkinetics.calculate_forces_and_moments.html">
       kineticstoolkit.pushrimkinetics.calculate_forces_and_moments
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.pushrimkinetics.calculate_power.html">
       kineticstoolkit.pushrimkinetics.calculate_power
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.pushrimkinetics.calculate_velocity.html">
       kineticstoolkit.pushrimkinetics.calculate_velocity
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.pushrimkinetics.read_file.html">
       kineticstoolkit.pushrimkinetics.read_file
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/kineticstoolkit.pushrimkinetics.remove_offsets.html">
       kineticstoolkit.pushrimkinetics.remove_offsets
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/kineticstoolkit.emg.html">
     kineticstoolkit.emg
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/kineticstoolkit.inversedynamics.html">
     kineticstoolkit.inversedynamics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/kineticstoolkit.anthropometrics.html">
     kineticstoolkit.anthropometrics
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ktk_citing.html">
   Citing
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dev_contributing.html">
   How to contribute
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_rules.html">
     Development rules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_code_of_conduct.html">
     Code of conduct
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_installing_from_github.html">
     Installing from GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dev_coding_style.html">
     Coding style
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="dev_tutorials.html">
   Developing tutorials for future features
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="dev_anthropometrics.html">
     Anthropometrics
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Inverse Dynamics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/felixchenier/kineticstoolkit">
   GitHub repository
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/dev_inversedynamics.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-sample-data">
   Loading sample data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#put-everything-relevant-into-one-synchronized-timeseries">
   Put everything relevant into one, synchronized TimeSeries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-force-and-moments-at-the-wrist">
   Calculate the force and moments at the wrist
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-com-position-of-the-wheel-segment">
     Calculate the COM position of the wheel segment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-com-acceleration-of-the-wheel-segment">
     Calculate the COM acceleration of the wheel segment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-wheel-segment-s-angles-around-the-global-x-y-and-z-axes">
     Calculate the wheel segment’s angles around the global x, y and z axes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-segment-s-angular-velocity-and-acceleration-around-the-global-x-y-and-z-axes">
     Calculate the segment’s angular velocity and acceleration around the global x, y and z axes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finally-calculate-the-proximal-forces-and-moments">
     Finally, calculate the proximal forces and moments
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-calculated-distal-forces-and-moments-to-the-ts-all-timeseries">
     Add the calculated distal forces and moments to the ts_all TimeSeries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-force-and-moments-at-the-elbow">
   Calculate the force and moments at the elbow
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-force-and-moments-at-the-shoulder">
   Calculate the force and moments at the shoulder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-the-forces-and-moments-in-the-local-coordinate-system">
   Get the forces and moments in the local coordinate system
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-forces">
     Local forces
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-moments">
     Local moments
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Inverse Dynamics</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-sample-data">
   Loading sample data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#put-everything-relevant-into-one-synchronized-timeseries">
   Put everything relevant into one, synchronized TimeSeries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-force-and-moments-at-the-wrist">
   Calculate the force and moments at the wrist
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-com-position-of-the-wheel-segment">
     Calculate the COM position of the wheel segment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-com-acceleration-of-the-wheel-segment">
     Calculate the COM acceleration of the wheel segment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-wheel-segment-s-angles-around-the-global-x-y-and-z-axes">
     Calculate the wheel segment’s angles around the global x, y and z axes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-segment-s-angular-velocity-and-acceleration-around-the-global-x-y-and-z-axes">
     Calculate the segment’s angular velocity and acceleration around the global x, y and z axes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finally-calculate-the-proximal-forces-and-moments">
     Finally, calculate the proximal forces and moments
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-calculated-distal-forces-and-moments-to-the-ts-all-timeseries">
     Add the calculated distal forces and moments to the ts_all TimeSeries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-force-and-moments-at-the-elbow">
   Calculate the force and moments at the elbow
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-force-and-moments-at-the-shoulder">
   Calculate the force and moments at the shoulder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-the-forces-and-moments-in-the-local-coordinate-system">
   Get the forces and moments in the local coordinate system
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-forces">
     Local forces
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-moments">
     Local moments
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="inverse-dynamics">
<h1>Inverse Dynamics<a class="headerlink" href="#inverse-dynamics" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This section refers to unstable code. This code may not be tested, and the whole API and behaviour is expected to change in the future. Do not use this code for your research.</p>
</div>
<p>The <a class="reference internal" href="api/kineticstoolkit.inversedynamics.html"><span class="doc std std-doc">inversedynamics</span></a> module calculates the proximal forces and moments based on the segment’s kinematics and distal forces and moments, based on the general method published in Dumas et al., 2004 <a class="footnote-reference brackets" href="#id2" id="id1">1</a>.</p>
<p>The results are the forces and moments applied by the distal segment on the
proximal articulation, in the global coordinates system.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This module will be redesigned to make use of the <code class="docutils literal notranslate"><span class="pre">anthropometrics</span></code> module currently in development.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">kineticstoolkit.lab</span> <span class="k">as</span> <span class="nn">ktk</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loading-sample-data">
<h2>Loading sample data<a class="headerlink" href="#loading-sample-data" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we will load propulsion data from a sprint in Wheelchair Basketball. Kinetics were recorded using an instrumented wheel (SmartWheel) and kinematics were recorded using an optoelectronic system (Optitrack). Both are synchronized.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load kinetics</span>
<span class="n">kinetics</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">ktk</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;inversedynamics_kinetics.ktk.zip&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Change some signs to match (locally): x anterior, # y up, z lateral (right)</span>
<span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Moments&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Moments&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Moments&#39;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Moments&#39;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Keep everything between sync and stop recording events.</span>
<span class="n">kinetics</span> <span class="o">=</span> <span class="n">kinetics</span><span class="o">.</span><span class="n">get_ts_between_events</span><span class="p">(</span><span class="s1">&#39;sync&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">)</span>

<span class="c1"># Look at the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">kinetics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;Forces&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">kinetics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;Moments&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dev_inversedynamics_3_0.png" src="_images/dev_inversedynamics_3_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load kinematics</span>
<span class="n">kinematics</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">ktk</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;inversedynamics_kinematics.ktk.zip&#39;</span><span class="p">)</span>
<span class="p">)[</span><span class="s1">&#39;Kinematics&#39;</span><span class="p">]</span>

<span class="c1"># Extract markers</span>
<span class="n">markers</span> <span class="o">=</span> <span class="n">kinematics</span><span class="p">[</span><span class="s1">&#39;Markers&#39;</span><span class="p">]</span>
<span class="n">markers</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">kinetics</span><span class="o">.</span><span class="n">events</span>

<span class="c1"># Extract frames</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">kinematics</span><span class="p">[</span><span class="s1">&#39;ReferenceFrames&#39;</span><span class="p">]</span>
<span class="n">frames</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">kinetics</span><span class="o">.</span><span class="n">events</span>

<span class="c1"># Keep everything between sync and stop recording events.</span>
<span class="n">markers</span> <span class="o">=</span> <span class="n">markers</span><span class="o">.</span><span class="n">get_ts_between_events</span><span class="p">(</span><span class="s1">&#39;sync&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">)</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">get_ts_between_events</span><span class="p">(</span><span class="s1">&#39;sync&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">)</span>

<span class="c1"># Plot one sample</span>
<span class="n">markers</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;RadialStyloidR&#39;</span><span class="p">)</span>

<span class="c1"># Check what markers are available</span>
<span class="n">markers</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                        &#39;Body_C7&#39;: &lt;array of shape (1210, 4)&gt;
                 &#39;Body_AcromionR&#39;: &lt;array of shape (1210, 4)&gt;
        &#39;Body_LateralEpicondyleR&#39;: &lt;array of shape (1210, 4)&gt;
                     &#39;Body_HandR&#39;: &lt;array of shape (1210, 4)&gt;
                    &#39;SWR_Marker1&#39;: &lt;array of shape (1210, 4)&gt;
                    &#39;SWR_Marker2&#39;: &lt;array of shape (1210, 4)&gt;
                    &#39;SWR_Marker3&#39;: &lt;array of shape (1210, 4)&gt;
                    &#39;SWR_Marker4&#39;: &lt;array of shape (1210, 4)&gt;
                   &#39;ArmR_Marker1&#39;: &lt;array of shape (1210, 4)&gt;
                   &#39;ArmR_Marker2&#39;: &lt;array of shape (1210, 4)&gt;
                   &#39;ArmR_Marker3&#39;: &lt;array of shape (1210, 4)&gt;
                   &#39;ArmR_Marker4&#39;: &lt;array of shape (1210, 4)&gt;
               &#39;ForearmR_Marker1&#39;: &lt;array of shape (1210, 4)&gt;
               &#39;ForearmR_Marker2&#39;: &lt;array of shape (1210, 4)&gt;
               &#39;ForearmR_Marker3&#39;: &lt;array of shape (1210, 4)&gt;
               &#39;ForearmR_Marker4&#39;: &lt;array of shape (1210, 4)&gt;
            &#39;WheelchairR_Marker1&#39;: &lt;array of shape (1210, 4)&gt;
            &#39;WheelchairR_Marker2&#39;: &lt;array of shape (1210, 4)&gt;
            &#39;WheelchairR_Marker3&#39;: &lt;array of shape (1210, 4)&gt;
            &#39;WheelchairR_Marker4&#39;: &lt;array of shape (1210, 4)&gt;
              &#39;RearWheelContactR&#39;: &lt;array of shape (1210, 4)&gt;
               &#39;RearWheelCenterR&#39;: &lt;array of shape (1210, 4)&gt;
                  &#39;RearWheelTopR&#39;: &lt;array of shape (1210, 4)&gt;
     &#39;BackwardRearAntitipCenterR&#39;: &lt;array of shape (1210, 4)&gt;
      &#39;ForwardRearAntitipCenterR&#39;: &lt;array of shape (1210, 4)&gt;
    &#39;BackwardFrontAntitipCenterR&#39;: &lt;array of shape (1210, 4)&gt;
     &#39;ForwardFrontAntitipCenterR&#39;: &lt;array of shape (1210, 4)&gt;
                      &#39;RearSeatR&#39;: &lt;array of shape (1210, 4)&gt;
                     &#39;FrontSeatR&#39;: &lt;array of shape (1210, 4)&gt;
                &#39;BackrestHeightR&#39;: &lt;array of shape (1210, 4)&gt;
             &#39;ExternalMalleolusR&#39;: &lt;array of shape (1210, 4)&gt;
      &#39;FemoralLateralEpicondyleR&#39;: &lt;array of shape (1210, 4)&gt;
              &#39;RearWheelContactL&#39;: &lt;array of shape (1210, 4)&gt;
               &#39;RearWheelCenterL&#39;: &lt;array of shape (1210, 4)&gt;
                  &#39;RearWheelTopL&#39;: &lt;array of shape (1210, 4)&gt;
     &#39;BackwardRearAntitipCenterL&#39;: &lt;array of shape (1210, 4)&gt;
      &#39;ForwardRearAntitipCenterL&#39;: &lt;array of shape (1210, 4)&gt;
    &#39;BackwardFrontAntitipCenterL&#39;: &lt;array of shape (1210, 4)&gt;
     &#39;ForwardFrontAntitipCenterL&#39;: &lt;array of shape (1210, 4)&gt;
                      &#39;RearSeatL&#39;: &lt;array of shape (1210, 4)&gt;
                     &#39;FrontSeatL&#39;: &lt;array of shape (1210, 4)&gt;
                &#39;BackrestHeightL&#39;: &lt;array of shape (1210, 4)&gt;
             &#39;ExternalMalleolusL&#39;: &lt;array of shape (1210, 4)&gt;
      &#39;FemoralLateralEpicondyleL&#39;: &lt;array of shape (1210, 4)&gt;
                         &#39;Meta2R&#39;: &lt;array of shape (1210, 4)&gt;
                         &#39;Meta5R&#39;: &lt;array of shape (1210, 4)&gt;
                 &#39;RadialStyloidR&#39;: &lt;array of shape (1210, 4)&gt;
                  &#39;UlnarStyloidR&#39;: &lt;array of shape (1210, 4)&gt;
                      &#39;OlecraneR&#39;: &lt;array of shape (1210, 4)&gt;
       &#39;HumeralMedialEpicondyleR&#39;: &lt;array of shape (1210, 4)&gt;
                         &#39;Meta2L&#39;: &lt;array of shape (1210, 4)&gt;
                         &#39;Meta5L&#39;: &lt;array of shape (1210, 4)&gt;
                 &#39;RadialStyloidL&#39;: &lt;array of shape (1210, 4)&gt;
                  &#39;UlnarStyloidL&#39;: &lt;array of shape (1210, 4)&gt;
                      &#39;OlecraneL&#39;: &lt;array of shape (1210, 4)&gt;
       &#39;HumeralMedialEpicondyleL&#39;: &lt;array of shape (1210, 4)&gt;
                         &#39;ElbowR&#39;: &lt;array of shape (1210, 4)&gt;
               &#39;WheelchairCenter&#39;: &lt;array of shape (1210, 4)&gt;
    &#39;WheelchairAnteriorDirection&#39;: &lt;array of shape (1210, 4)&gt;
                           &#39;L5S1&#39;: &lt;array of shape (1210, 4)&gt;
}
</pre></div>
</div>
<img alt="_images/dev_inversedynamics_4_1.png" src="_images/dev_inversedynamics_4_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check what frames are available</span>
<span class="n">frames</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
    &#39;Wheelchair&#39;: &lt;array of shape (1210, 4, 4)&gt;
         &#39;Trunk&#39;: &lt;array of shape (1210, 4, 4)&gt;
        &#39;WheelL&#39;: &lt;array of shape (1210, 4, 4)&gt;
        &#39;WheelR&#39;: &lt;array of shape (1210, 4, 4)&gt;
      &#39;HumerusR&#39;: &lt;array of shape (1210, 4, 4)&gt;
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="put-everything-relevant-into-one-synchronized-timeseries">
<h2>Put everything relevant into one, synchronized TimeSeries<a class="headerlink" href="#put-everything-relevant-into-one-synchronized-timeseries" title="Permalink to this headline">¶</a></h2>
<p>We will now create a single TimeSeries with every relevant signal. Note that for kinematics, we use <code class="docutils literal notranslate"><span class="pre">merge</span></code> instead of simply copying the data, because kinetics and kinematics have different sampling rate and therefore the data have different lengths. Merging takes care of resampling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_all</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>

<span class="c1"># Add frames (to put pushrim kinetics in global coordinates,</span>
<span class="c1"># and at the end to express shoulder dynamics in local coordinates).</span>
<span class="n">ts_all</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">get_subset</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;WheelR&#39;</span><span class="p">,</span> <span class="s1">&#39;HumerusR&#39;</span><span class="p">,</span> <span class="s1">&#39;Trunk&#39;</span><span class="p">]),</span>
    <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Add the forces and moments, expressed in global coordinates.</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;HubForces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">get_global_coordinates</span><span class="p">(</span>
    <span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">],</span>
    <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WheelR&#39;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;HubMoments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">get_global_coordinates</span><span class="p">(</span>
    <span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Moments&#39;</span><span class="p">],</span>
    <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WheelR&#39;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="c1"># Add relevant markers</span>
<span class="n">ts_all</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">markers</span><span class="o">.</span><span class="n">get_subset</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;RearWheelCenterR&#39;</span><span class="p">,</span> <span class="s1">&#39;RadialStyloidR&#39;</span><span class="p">,</span> <span class="s1">&#39;ElbowR&#39;</span><span class="p">,</span> <span class="s1">&#39;Body_AcromionR&#39;</span><span class="p">]),</span>
    <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Check the contents of this TimeSeries</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
              &#39;WheelR&#39;: &lt;array of shape (2421, 4, 4)&gt;
            &#39;HumerusR&#39;: &lt;array of shape (2421, 4, 4)&gt;
               &#39;Trunk&#39;: &lt;array of shape (2421, 4, 4)&gt;
           &#39;HubForces&#39;: &lt;array of shape (2421, 4)&gt;
          &#39;HubMoments&#39;: &lt;array of shape (2421, 4)&gt;
    &#39;RearWheelCenterR&#39;: &lt;array of shape (2421, 4)&gt;
      &#39;RadialStyloidR&#39;: &lt;array of shape (2421, 4)&gt;
              &#39;ElbowR&#39;: &lt;array of shape (2421, 4)&gt;
      &#39;Body_AcromionR&#39;: &lt;array of shape (2421, 4)&gt;
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-the-force-and-moments-at-the-wrist">
<h2>Calculate the force and moments at the wrist<a class="headerlink" href="#calculate-the-force-and-moments-at-the-wrist" title="Permalink to this headline">¶</a></h2>
<p>The same calculation is done on every segment, from distal to proximal. We begin with the segment ‘Wheel’ with the point of force application at the hub (since the measured values are referred at the hub).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an empty TimeSeries</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>

<span class="c1"># Add the kinetics data to this TimeSeries</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalForces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;HubForces&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalMoments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;HubMoments&#39;</span><span class="p">]</span>

<span class="c1"># Add the kinematics data to this TimeSeries.</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ForceApplicationPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RearWheelCenterR&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalJointPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RearWheelCenterR&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalJointPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RadialStyloidR&#39;</span><span class="p">]</span>

<span class="c1"># Check the contents of the resulting TimeSeries.</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                &#39;DistalForces&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;DistalMoments&#39;: &lt;array of shape (2421, 4)&gt;
    &#39;ForceApplicationPosition&#39;: &lt;array of shape (2421, 4)&gt;
         &#39;DistalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
       &#39;ProximalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
}
</pre></div>
</div>
</div>
</div>
<p>We now have everything to start computing the forces and moments at the wrist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We neglect the inertial properties of the wheel. This is a limit and we could improve on this.</span>
<span class="n">inertial_constants</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Mass&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;COMProximalRatio&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;GyrationCOMRatio&#39;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="calculate-the-com-position-of-the-wheel-segment">
<h3>Calculate the COM position of the wheel segment<a class="headerlink" href="#calculate-the-com-position-of-the-wheel-segment" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_com_position</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">inertial_constants</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                &#39;DistalForces&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;DistalMoments&#39;: &lt;array of shape (2421, 4)&gt;
    &#39;ForceApplicationPosition&#39;: &lt;array of shape (2421, 4)&gt;
         &#39;DistalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
       &#39;ProximalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
                 &#39;COMPosition&#39;: &lt;array of shape (2421, 4)&gt;
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-the-com-acceleration-of-the-wheel-segment">
<h3>Calculate the COM acceleration of the wheel segment<a class="headerlink" href="#calculate-the-com-acceleration-of-the-wheel-segment" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_com_acceleration</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                &#39;DistalForces&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;DistalMoments&#39;: &lt;array of shape (2421, 4)&gt;
    &#39;ForceApplicationPosition&#39;: &lt;array of shape (2421, 4)&gt;
         &#39;DistalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
       &#39;ProximalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
                 &#39;COMPosition&#39;: &lt;array of shape (2421, 4)&gt;
             &#39;COMAcceleration&#39;: &lt;array of shape (2421, 4)&gt;
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-the-wheel-segment-s-angles-around-the-global-x-y-and-z-axes">
<h3>Calculate the wheel segment’s angles around the global x, y and z axes<a class="headerlink" href="#calculate-the-wheel-segment-s-angles-around-the-global-x-y-and-z-axes" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_segment_angles</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                &#39;DistalForces&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;DistalMoments&#39;: &lt;array of shape (2421, 4)&gt;
    &#39;ForceApplicationPosition&#39;: &lt;array of shape (2421, 4)&gt;
         &#39;DistalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
       &#39;ProximalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
                 &#39;COMPosition&#39;: &lt;array of shape (2421, 4)&gt;
             &#39;COMAcceleration&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;SegmentAngles&#39;: &lt;array of shape (2421, 3)&gt;
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-the-segment-s-angular-velocity-and-acceleration-around-the-global-x-y-and-z-axes">
<h3>Calculate the segment’s angular velocity and acceleration around the global x, y and z axes<a class="headerlink" href="#calculate-the-segment-s-angular-velocity-and-acceleration-around-the-global-x-y-and-z-axes" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_segment_rotation_rates</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                &#39;DistalForces&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;DistalMoments&#39;: &lt;array of shape (2421, 4)&gt;
    &#39;ForceApplicationPosition&#39;: &lt;array of shape (2421, 4)&gt;
         &#39;DistalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
       &#39;ProximalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
                 &#39;COMPosition&#39;: &lt;array of shape (2421, 4)&gt;
             &#39;COMAcceleration&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;SegmentAngles&#39;: &lt;array of shape (2421, 3)&gt;
             &#39;AngularVelocity&#39;: &lt;array of shape (2421, 3)&gt;
         &#39;AngularAcceleration&#39;: &lt;array of shape (2421, 3)&gt;
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="finally-calculate-the-proximal-forces-and-moments">
<h3>Finally, calculate the proximal forces and moments<a class="headerlink" href="#finally-calculate-the-proximal-forces-and-moments" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_proximal_wrench</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">inertial_constants</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                &#39;DistalForces&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;DistalMoments&#39;: &lt;array of shape (2421, 4)&gt;
    &#39;ForceApplicationPosition&#39;: &lt;array of shape (2421, 4)&gt;
         &#39;DistalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
       &#39;ProximalJointPosition&#39;: &lt;array of shape (2421, 4)&gt;
                 &#39;COMPosition&#39;: &lt;array of shape (2421, 4)&gt;
             &#39;COMAcceleration&#39;: &lt;array of shape (2421, 4)&gt;
               &#39;SegmentAngles&#39;: &lt;array of shape (2421, 3)&gt;
             &#39;AngularVelocity&#39;: &lt;array of shape (2421, 3)&gt;
         &#39;AngularAcceleration&#39;: &lt;array of shape (2421, 3)&gt;
            &#39;RadiusOfGyration&#39;: &lt;array of shape (2421, 3)&gt;
              &#39;ProximalForces&#39;: &lt;array of shape (2421, 4)&gt;
             &#39;ProximalMoments&#39;: &lt;array of shape (2421, 4)&gt;
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-the-calculated-distal-forces-and-moments-to-the-ts-all-timeseries">
<h3>Add the calculated distal forces and moments to the ts_all TimeSeries<a class="headerlink" href="#add-the-calculated-distal-forces-and-moments-to-the-ts-all-timeseries" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WristForces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalForces&#39;</span><span class="p">]</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WristMoments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalMoments&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the hub and wrist forces (identical since</span>
<span class="c1"># there were no inertial constants on this segment)</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">&#39;HubForces&#39;</span><span class="p">,</span> <span class="s1">&#39;WristForces&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dev_inversedynamics_24_0.png" src="_images/dev_inversedynamics_24_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the hub and wrist moments (not identical</span>
<span class="c1"># because of the lever arm between the hub and wrist)</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">&#39;HubMoments&#39;</span><span class="p">,</span> <span class="s1">&#39;WristMoments&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dev_inversedynamics_25_0.png" src="_images/dev_inversedynamics_25_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="calculate-the-force-and-moments-at-the-elbow">
<h2>Calculate the force and moments at the elbow<a class="headerlink" href="#calculate-the-force-and-moments-at-the-elbow" title="Permalink to this headline">¶</a></h2>
<p>The method is identical for the other segments. However, for these segments, we will define inertial constants based on anthropometric tables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertial_constants</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">get_anthropometrics</span><span class="p">(</span>
    <span class="n">segment_name</span><span class="o">=</span><span class="s1">&#39;Forearm&#39;</span><span class="p">,</span>
    <span class="n">total_mass</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

<span class="n">inertial_constants</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                     &#39;Mass&#39;: 1.28
         &#39;COMProximalRatio&#39;: 0.43
           &#39;COMDistalRatio&#39;: 0.57
         &#39;GyrationCOMRatio&#39;: 0.303
    &#39;GyrationProximalRatio&#39;: 0.526
      &#39;GyrationDistalRatio&#39;: 0.647
}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an empty TimeSeries</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>

<span class="c1"># Add the kinetics data to this TimeSeries</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalForces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WristForces&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalMoments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WristMoments&#39;</span><span class="p">]</span>

<span class="c1"># Add the kinematics data to this TimeSeries.</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ForceApplicationPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RadialStyloidR&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalJointPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RadialStyloidR&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalJointPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ElbowR&#39;</span><span class="p">]</span>

<span class="c1"># Calculate the COM position and acceleration</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_com_position</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">inertial_constants</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_com_acceleration</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Calculate the segment&#39;s angle, angular velocity and angular acceleration</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_segment_angles</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_segment_rotation_rates</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Calculate the proximal forces and moments</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_proximal_wrench</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">inertial_constants</span><span class="p">)</span>

<span class="c1"># Add the calculated forces and moments to ts_all</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ElbowForces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalForces&#39;</span><span class="p">]</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ElbowMoments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalMoments&#39;</span><span class="p">]</span>

<span class="c1"># Compare the wrist forces to the elbow forces</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">&#39;WristForces&#39;</span><span class="p">,</span> <span class="s1">&#39;ElbowForces&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dev_inversedynamics_28_0.png" src="_images/dev_inversedynamics_28_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the wrist moments to the elbow moments</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">&#39;WristMoments&#39;</span><span class="p">,</span> <span class="s1">&#39;ElbowMoments&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dev_inversedynamics_29_0.png" src="_images/dev_inversedynamics_29_0.png" />
</div>
</div>
</div>
<div class="section" id="calculate-the-force-and-moments-at-the-shoulder">
<h2>Calculate the force and moments at the shoulder<a class="headerlink" href="#calculate-the-force-and-moments-at-the-shoulder" title="Permalink to this headline">¶</a></h2>
<p>We proceed exactly as for the elbow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertial_constants</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">get_anthropometrics</span><span class="p">(</span>
    <span class="n">segment_name</span><span class="o">=</span><span class="s1">&#39;UpperArm&#39;</span><span class="p">,</span>
    <span class="n">total_mass</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

<span class="n">inertial_constants</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
                     &#39;Mass&#39;: 2.24
         &#39;COMProximalRatio&#39;: 0.436
           &#39;COMDistalRatio&#39;: 0.564
         &#39;GyrationCOMRatio&#39;: 0.322
    &#39;GyrationProximalRatio&#39;: 0.542
      &#39;GyrationDistalRatio&#39;: 0.645
}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an empty TimeSeries</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">kinetics</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>

<span class="c1"># Add the kinetics data to this TimeSeries</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalForces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ElbowForces&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalMoments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ElbowMoments&#39;</span><span class="p">]</span>

<span class="c1"># Add the kinematics data to this TimeSeries.</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ForceApplicationPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ElbowR&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DistalJointPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ElbowR&#39;</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalJointPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Body_AcromionR&#39;</span><span class="p">]</span>

<span class="c1"># Calculate the COM position and acceleration</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_com_position</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">inertial_constants</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_com_acceleration</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Calculate the segment&#39;s angle, angular velocity and angular acceleration</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_segment_angles</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_segment_rotation_rates</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Calculate the proximal forces and moments</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_proximal_wrench</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">inertial_constants</span><span class="p">)</span>

<span class="c1"># Add the calculated forces and moments to ts_all</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ShoulderForces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalForces&#39;</span><span class="p">]</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ShoulderMoments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ProximalMoments&#39;</span><span class="p">]</span>

<span class="c1"># Compare the elbow forces to the shoulder forces</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">&#39;ElbowForces&#39;</span><span class="p">,</span> <span class="s1">&#39;ShoulderForces&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dev_inversedynamics_32_0.png" src="_images/dev_inversedynamics_32_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the elbow moments to the shoulder moments</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">&#39;ElbowMoments&#39;</span><span class="p">,</span> <span class="s1">&#39;ShoulderMoments&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dev_inversedynamics_33_0.png" src="_images/dev_inversedynamics_33_0.png" />
</div>
</div>
</div>
<div class="section" id="get-the-forces-and-moments-in-the-local-coordinate-system">
<h2>Get the forces and moments in the local coordinate system<a class="headerlink" href="#get-the-forces-and-moments-in-the-local-coordinate-system" title="Permalink to this headline">¶</a></h2>
<p>Please note that every force and moment we just calculated is expressed in global coordinates, which is of limited value for interpretation. It is much more useful to express these data in local coordinates. Several conventions may be used, here we will express the shoulder forces in the trunk coordinate system, and the shoulder moments in the humeral coordinate system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new TimeSeries</span>
<span class="n">local_joint_dynamics</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ts_all</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">ts_all</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>

<span class="c1"># Fill it with the external forces</span>
<span class="n">local_joint_dynamics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">get_local_coordinates</span><span class="p">(</span>
    <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ShoulderForces&#39;</span><span class="p">],</span>
    <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Trunk&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># This is the forces applied by the trunk on the humerus. Normally we want the contrary,</span>
<span class="c1"># the external forces applied by the humerus on the trunk:</span>
<span class="n">local_joint_dynamics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">local_joint_dynamics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Forces&#39;</span><span class="p">]</span>

<span class="n">local_joint_dynamics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Moments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">get_local_coordinates</span><span class="p">(</span>
    <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ShoulderMoments&#39;</span><span class="p">],</span>
    <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;HumerusR&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="local-forces">
<h3>Local forces<a class="headerlink" href="#local-forces" title="Permalink to this headline">¶</a></h3>
<p>Let’s plot the shoulder forces in the trunk reference frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local_joint_dynamics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;Forces&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Upward&#39;</span><span class="p">,</span> <span class="s1">&#39;Lateral&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;External forces in the trunk coordinate system:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>External forces in the trunk coordinate system:
</pre></div>
</div>
<img alt="_images/dev_inversedynamics_37_1.png" src="_images/dev_inversedynamics_37_1.png" />
</div>
</div>
</div>
<div class="section" id="local-moments">
<h3>Local moments<a class="headerlink" href="#local-moments" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local_joint_dynamics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;Moments&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Abduction&#39;</span><span class="p">,</span> <span class="s1">&#39;Internal rotation&#39;</span><span class="p">,</span> <span class="s1">&#39;Flexion&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Net internal shoulder moments:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Net internal shoulder moments:
</pre></div>
</div>
<img alt="_images/dev_inversedynamics_39_1.png" src="_images/dev_inversedynamics_39_1.png" />
</div>
</div>
<p>For more information on inversedynamics, please check the <a class="reference internal" href="api/kineticstoolkit.inversedynamics.html"><span class="doc std std-doc">API Reference for the inversedynamics module</span></a>.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>R. Dumas, R. Aissaoui, and J. A. De Guise, “A 3D generic inverse dynamic method using wrench notation and quaternion algebra,” Comput Meth Biomech Biomed Eng, vol. 7, no. 3, pp. 159–166, 2004.</p>
</dd>
</dl>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="dev_anthropometrics.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Anthropometrics</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Félix Chénier<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>