

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>📖 Working with cycles &#8212; Kinetics Toolkit</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cycles';</script>
    <link rel="canonical" href="https://kineticstoolkit.uqam.ca/doc/cycles.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="📖 3D rigid body geometry" href="geometry.html" />
    <link rel="prev" title="📖 Removing artefacts using a median filter" href="filters_median.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="ktk_manual.html">📘 Manual</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ktk_overview.html">📖 An overview of Kinetics Toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="ktk_installing.html">📖 Installing and importing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="timeseries.html">📖 TimeSeries</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="timeseries_basics.html">📖 TimeSeries basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="timeseries_manipulating.html">📖 Manipulating TimeSeries</a></li>
<li class="toctree-l3"><a class="reference internal" href="timeseries_dataframes.html">📖 Converting between TimeSeries and pandas DataFrames</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="loadsave.html">📖 Saving and loading</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="filters.html">📖 Filtering</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="filters_butter.html">📖 Butterworth filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="filters_smooth_savgol.html">📖 Moving average and Savitsky-Golay</a></li>
<li class="toctree-l3"><a class="reference internal" href="filters_median.html">📖 Removing artefacts using a median filter</a></li>
</ul>
</li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">📖 Working with cycles</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="geometry.html">📖 3D rigid body geometry</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="geometry_basics.html">📖 Coordinates: points, vectors and frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry_transform_moving_coordinates.html">📖 The homogeneous transform: rotating and translating coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry_transform_changing_coordinate_system.html">📖 The homogeneous transform: mapping coordinates to other coordinate systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry_kinematic_chains.html">📖 Kinematic chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry_angles.html">📖 Extracting angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry_dimension_conventions.html">📖 Dimension conventions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="kinematics.html">📖 Kinematics analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="kinematics_load_visualize.html">📖 Reading and visualizing markers in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_joint_angles.html">📖 Calculating joint angles from a kinematic acquisition</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_reconstructing_occluded_markers.html">📖 Reconstructing occluded markers</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_reconstructing_removed_markers.html">📖 Reconstructing removed markers</a></li>
<li class="toctree-l3"><a class="reference internal" href="kinematics_reconstructing_probed_points.html">📖 Reconstructing probed points</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="extensions.html">📖 Extensions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api_reference.html">📘 API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ktk_conventions.html">📖 Conventions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api_classes.html">📖 Classes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/ktk.TimeSeries.html">ktk.TimeSeries</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.add_data_info.html">ktk.TimeSeries.add_data_info</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.add_event.html">ktk.TimeSeries.add_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.copy.html">ktk.TimeSeries.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.count_events.html">ktk.TimeSeries.count_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.fill_missing_samples.html">ktk.TimeSeries.fill_missing_samples</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.from_dataframe.html">ktk.TimeSeries.from_dataframe</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_event_index.html">ktk.TimeSeries.get_event_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_event_time.html">ktk.TimeSeries.get_event_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_index_after_time.html">ktk.TimeSeries.get_index_after_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_index_at_time.html">ktk.TimeSeries.get_index_at_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_index_before_time.html">ktk.TimeSeries.get_index_before_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_sample_rate.html">ktk.TimeSeries.get_sample_rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_subset.html">ktk.TimeSeries.get_subset</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_after_event.html">ktk.TimeSeries.get_ts_after_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_after_index.html">ktk.TimeSeries.get_ts_after_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_after_time.html">ktk.TimeSeries.get_ts_after_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_at_event.html">ktk.TimeSeries.get_ts_at_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_at_time.html">ktk.TimeSeries.get_ts_at_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_before_event.html">ktk.TimeSeries.get_ts_before_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_before_index.html">ktk.TimeSeries.get_ts_before_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_before_time.html">ktk.TimeSeries.get_ts_before_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_between_events.html">ktk.TimeSeries.get_ts_between_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_between_indexes.html">ktk.TimeSeries.get_ts_between_indexes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.get_ts_between_times.html">ktk.TimeSeries.get_ts_between_times</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.isnan.html">ktk.TimeSeries.isnan</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.merge.html">ktk.TimeSeries.merge</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.plot.html">ktk.TimeSeries.plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.remove_data.html">ktk.TimeSeries.remove_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.remove_data_info.html">ktk.TimeSeries.remove_data_info</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.remove_duplicate_events.html">ktk.TimeSeries.remove_duplicate_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.remove_event.html">ktk.TimeSeries.remove_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.rename_data.html">ktk.TimeSeries.rename_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.rename_event.html">ktk.TimeSeries.rename_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.resample.html">ktk.TimeSeries.resample</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.shift.html">ktk.TimeSeries.shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.sort_events.html">ktk.TimeSeries.sort_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.sync_event.html">ktk.TimeSeries.sync_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.to_dataframe.html">ktk.TimeSeries.to_dataframe</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.trim_events.html">ktk.TimeSeries.trim_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.ui_edit_events.html">ktk.TimeSeries.ui_edit_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.ui_get_ts_between_clicks.html">ktk.TimeSeries.ui_get_ts_between_clicks</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.TimeSeries.ui_sync.html">ktk.TimeSeries.ui_sync</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/ktk.TimeSeriesEvent.html">ktk.TimeSeriesEvent</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/ktk.Player.html">ktk.Player</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.Player.close.html">ktk.Player.close</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.Player.to_html5.html">ktk.Player.to_html5</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api_functions.html">📖 Functions</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/ktk.import_extensions.html">ktk.import_extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/ktk.load.html">ktk.load</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/ktk.save.html">ktk.save</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/ktk.read_c3d.html">ktk.read_c3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/ktk.write_c3d.html">ktk.write_c3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/ktk.change_defaults.html">ktk.change_defaults</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api_modules.html">📖 Modules</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/ktk.cycles.html">ktk.cycles</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.cycles.detect_cycles.html">ktk.cycles.detect_cycles</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.cycles.most_repeatable_cycles.html">ktk.cycles.most_repeatable_cycles</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.cycles.stack.html">ktk.cycles.stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.cycles.time_normalize.html">ktk.cycles.time_normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.cycles.unstack.html">ktk.cycles.unstack</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/ktk.doc.html">ktk.doc</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.doc.download.html">ktk.doc.download</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/ktk.filters.html">ktk.filters</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.filters.butter.html">ktk.filters.butter</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.filters.deriv.html">ktk.filters.deriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.filters.median.html">ktk.filters.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.filters.savgol.html">ktk.filters.savgol</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.filters.smooth.html">ktk.filters.smooth</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/ktk.geometry.html">ktk.geometry</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.create_frames.html">ktk.geometry.create_frames</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.create_transforms.html">ktk.geometry.create_transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.get_angles.html">ktk.geometry.get_angles</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.get_global_coordinates.html">ktk.geometry.get_global_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.get_local_coordinates.html">ktk.geometry.get_local_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.isnan.html">ktk.geometry.isnan</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.matmul.html">ktk.geometry.matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.geometry.register_points.html">ktk.geometry.register_points</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/ktk.kinematics.html">ktk.kinematics</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.kinematics.create_cluster.html">ktk.kinematics.create_cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.kinematics.extend_cluster.html">ktk.kinematics.extend_cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/ktk.kinematics.track_cluster.html">ktk.kinematics.track_cluster</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dev_extensions.html">📖 Developing extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="ktk_release_notes.html">🗓 Release Notes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dev_contributing.html">👋 How to contribute</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ktk_citing.html">📄 Citing</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_rules.html">📖 Development rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_code_of_conduct.html">📖 Code of conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_installing_from_github.html">📖 Installing from GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_coding_style.html">📖 Coding style</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/felixchenier/kineticstoolkit">🌎 GitHub repository</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="python_for_beginners.html">📘 Learning Python for biomechanics</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="python_getting_started.html">📖 Getting started with Python</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="python_installing.html">📖 Installing Python, Spyder and the most important scientific packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_configuring_spyder.html">📖 Configuring Spyder for Python biomechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_using_spyder.html">📖 Using Spyder</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="python.html">📖 The Python language</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="python_arithmetics_and_variables.html">📖 Arithmetics and variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_numbers.html">📖 Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_strings.html">📖 Strings basics</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="python_functions.html">📖 Functions</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="python_functions_syntax.html">📖 Function syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_functions_docstrings.html">📖 Docstrings</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_functions_keywords_defaults.html">📖 Keyword arguments and default values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python_conditions.html">📖 Conditions and booleans</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="python_lists.html">📖 Lists and tuples</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="python_lists_indexing.html">📖 Creating and indexing lists/tuples</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_lists_slicing.html">📖 Slicing lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_lists_mutability.html">📖 Manipulating lists</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="python_looping.html">📖 Looping</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="python_while.html">📖 Looping using <code class="docutils literal notranslate"><span class="pre">while</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="python_for_range.html">📖 Looping using <code class="docutils literal notranslate"><span class="pre">for</span></code> and <code class="docutils literal notranslate"><span class="pre">range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="python_for_enumerate.html">📖 Looping though a list using <code class="docutils literal notranslate"><span class="pre">enumerate</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python_dicts.html">📖 Dictionaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_integration_exercises.html">📖 Integration exercises</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="matplotlib.html">📖 Matplotlib</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="matplotlib_import.html">📖 Importing <code class="docutils literal notranslate"><span class="pre">pyplot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="matplotlib_frontend.html">📖 Non-blocking, interactive Matplotlib figures</a></li>
<li class="toctree-l3"><a class="reference internal" href="matplotlib_plot.html">📖 Line plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="matplotlib_subplot.html">📖 Multiple plots side by side</a></li>
<li class="toctree-l3"><a class="reference internal" href="matplotlib_style.html">📖 Markers, line style and colours</a></li>
<li class="toctree-l3"><a class="reference internal" href="matplotlib_axis.html">📖 Setting the axes limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="matplotlib_ginput.html">📖 Graphical input</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="numpy.html">📖 NumPy</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="numpy_ndarray.html">📖 Arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="numpy_arithmetics_and_comparisons.html">📖 Arithmetics and comparisons</a></li>
<li class="toctree-l3"><a class="reference internal" href="numpy_indexing_slicing_filtering_1d.html">📖 Indexing, slicing and filtering unidimensional arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="numpy_indexing_slicing_filtering_nd.html">📖 Indexing, slicing and filtering multidimensional arrays</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pandas.html">🚧 Pandas</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/cycles.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>📖 Working with cycles</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-cycles">📄 Detecting cycles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-normalizing-cycles">📄 Time-normalizing cycles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-the-cycles">📄 Combining the cycles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-most-repeatable-cycles">📄 Finding the most repeatable cycles</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-cycles">
<h1>📖 Working with cycles<a class="headerlink" href="#working-with-cycles" title="Permalink to this headline">#</a></h1>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Summary</div>
<p class="sd-card-text">This section shows the <a class="reference internal" href="api/ktk.cycles.html"><span class="doc std std-doc">ktk.cycles</span></a> module, which detects cycles in TimeSeries, time-normalizes these cycles, finds the most repeatable ones, and stack/ unstack them.</p>
</div>
</div>
<p>Since many movements are cyclic (e.g., gait), it is often useful to identify these cycles and work on a per-cycle basis instead of long acquisitions. The <a class="reference internal" href="api/ktk.cycles.html"><span class="doc std std-doc">ktk.cycles</span></a> module provides some functions to detect, time-normalize and stack cycles, and to find the most repeatable cycles among a set of stacked cycles.</p>
<p>This section showcases this module, using kinetics data from wheelchair propulsion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">kineticstoolkit.lab</span> <span class="k">as</span> <span class="nn">ktk</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Load the instrumented wheel data</span>

<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ktk</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;wheelchair_kinetics.ktk.zip&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>At this point, we have a TimeSeries that contains several signals, including forces and moments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Forces&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Moments&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d2d227019087f8aa02ed8235f84c1faaac7c5c01c639c4418acfada7b2a12bc9.png" src="_images/d2d227019087f8aa02ed8235f84c1faaac7c5c01c639c4418acfada7b2a12bc9.png" />
</div>
</div>
<section id="detecting-cycles">
<h2>📄 Detecting cycles<a class="headerlink" href="#detecting-cycles" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="api/ktk.cycles.detect_cycles.html"><span class="doc std std-doc">ktk.cycles.detect_cycles</span></a> function detects biphasic cycles in a TimeSeries, and add the transitions as events. Each cycle has three events:</p>
<ul class="simple">
<li><p>The start of the first phase, named using the <code class="docutils literal notranslate"><span class="pre">event_names</span></code> parameters;</p></li>
<li><p>The start of the second phase, also named using the <code class="docutils literal notranslate"><span class="pre">event_names</span></code> parameters;</p></li>
<li><p>The end of the cycle, always named <code class="docutils literal notranslate"><span class="pre">_</span></code>.</p></li>
</ul>
<p>The function does not modify the TimeSeries data, only the events. It uses two thresholds applied to one, unidimensional signal from this TimeSeries. In this example, this signal will be the total force <span class="math notranslate nohighlight">\(F_{tot}\)</span>. This could also apply to gait, or one could also use only the vertical ground reaction force, depending on the lab’s convention or methods.</p>
<p>Let’s calculate <span class="math notranslate nohighlight">\(F_{tot}\)</span> based on the three force components, and add it as a new data of the TimeSeries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Ftot</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ftot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Forces&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Plot it</span>
<span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Forces&quot;</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9befcdf302e4a747751cb6adce466e7b24914a9e94cc958b8a1415998f0a6d8a.png" src="_images/9befcdf302e4a747751cb6adce466e7b24914a9e94cc958b8a1415998f0a6d8a.png" />
</div>
</div>
<p>We then define threshold values for <span class="math notranslate nohighlight">\(F_\text{tot}\)</span>. While we could use a single threshold value (e.g., everything above 12 N corresponds to a push, everything below 12 N corresponds to a recovery), it is generally more robust to use two thresholds: one (higher) that registers the beginning of a push, and another (lower) that registers the beginning of a recovery. This method is more robust to noise: it won’t register a cycle simply because the signal moves around the threshold during the transitions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">detect_cycles</span><span class="p">(</span>
    <span class="n">ts</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">,</span> <span class="n">event_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;recovery&quot;</span><span class="p">],</span> <span class="n">thresholds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Forces&quot;</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/20bdefb43db716608d695800245f33553fca939e17951a03f658cfed316fccac.png" src="_images/20bdefb43db716608d695800245f33553fca939e17951a03f658cfed316fccac.png" />
</div>
</div>
<p>We observe that most cycles are well identified, but a short spike at the beginning was wrongly identified as a cycle. In reality, this is a synchronization spike used to sync data between many instruments. We can reject detected cycles that are deemed to short by specifying minimal durations for both phases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">detect_cycles</span><span class="p">(</span>
    <span class="n">ts</span><span class="p">,</span>
    <span class="s2">&quot;Ftot&quot;</span><span class="p">,</span>
    <span class="n">event_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;recovery&quot;</span><span class="p">],</span>
    <span class="n">thresholds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="n">min_durations</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Forces&quot;</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/964ad2e1298d1629f13359dae76ea61f7c6e4ca96aef10d1f0fce8ebe43d3d53.png" src="_images/964ad2e1298d1629f13359dae76ea61f7c6e4ca96aef10d1f0fce8ebe43d3d53.png" />
</div>
</div>
<p>There are other arguments available to filter out more cycles, such as max durations, and minimal/maximal peak height. The <a class="reference internal" href="api/ktk.cycles.detect_cycles.html"><span class="doc std std-doc">API</span></a> describes these arguments thoughtfully.</p>
<p>For example, in this signal, the next to last cycle corresponds to a braking phase and we may want to remove it. For this very signal, this can be done using a minimal peak height requirement:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_with_events</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">detect_cycles</span><span class="p">(</span>
    <span class="n">ts</span><span class="p">,</span>
    <span class="s2">&quot;Ftot&quot;</span><span class="p">,</span>
    <span class="n">event_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;recovery&quot;</span><span class="p">],</span>
    <span class="n">thresholds</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="n">min_durations</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="n">min_peak_heights</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">Inf</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">ts_with_events</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Forces&quot;</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f3d8854c095a6c3a34dfd0a7a4b6f97139a738c5e85adf4797861a5a5416e173.png" src="_images/f3d8854c095a6c3a34dfd0a7a4b6f97139a738c5e85adf4797861a5a5416e173.png" />
</div>
</div>
<p>We observe an <code class="docutils literal notranslate"><span class="pre">_</span></code> event at about 27 seconds. There are in fact such <code class="docutils literal notranslate"><span class="pre">_</span></code> events at the end of each cycle (look how each next push’s ‘p’ letter seems underlined). As explained above, the <code class="docutils literal notranslate"><span class="pre">detect_cycles</span></code> function adds an <code class="docutils literal notranslate"><span class="pre">_</span></code> event at the end of each cycle; the one at 27 seconds just happens to not correspond to the begin of a new cycle.</p>
</section>
<section id="time-normalizing-cycles">
<h2>📄 Time-normalizing cycles<a class="headerlink" href="#time-normalizing-cycles" title="Permalink to this headline">#</a></h2>
<p>Once the cycles have been detected, we can time-normalize them using <a class="reference internal" href="api/ktk.cycles.time_normalize.html"><span class="doc std std-doc">ktk.cycles.time_normalize</span></a> to get them on the same time scale (a percentage of the cycle).</p>
<p>Here, every 12 complete cycles will be time-normalized from 0 to 100%, with a new cycle starting at every multiple of 100%:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_normalized_on_cycle</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">time_normalize</span><span class="p">(</span>
    <span class="n">ts_with_events</span><span class="p">,</span> <span class="n">event_name1</span><span class="o">=</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">event_name2</span><span class="o">=</span><span class="s2">&quot;_&quot;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ts_normalized_on_cycle</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Forces&quot;</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ts_normalized_on_cycle</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Moments&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/df9e243333b613f11b027d422815c0d5962777ebd489842a0c3f43552b7a5e7e.png" src="_images/df9e243333b613f11b027d422815c0d5962777ebd489842a0c3f43552b7a5e7e.png" />
</div>
</div>
<p>To time-normalize only during the push phase, we would define <code class="docutils literal notranslate"><span class="pre">event_name2</span></code> as “recovery” instead of ” _ “. Note in the original data that we had a total of 12 complete transitions from “push” to ” _ “. The end of the last cycle could not be identified since no new push started after.</p>
<p>If we are only interested in transitions from “push” to “recovery”, then we have a total of <strong>13</strong> complete pushes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_normalized_on_push</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">time_normalize</span><span class="p">(</span>
    <span class="n">ts_with_events</span><span class="p">,</span> <span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;recovery&quot;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ts_normalized_on_push</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Forces&quot;</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ts_normalized_on_push</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Moments&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ed744b7abc3ab8a9213763b7872fea58232cbb668d31115886add4848d5da909.png" src="_images/ed744b7abc3ab8a9213763b7872fea58232cbb668d31115886add4848d5da909.png" />
</div>
</div>
<p>It is also possible to include data before 0% and after 100% using the <code class="docutils literal notranslate"><span class="pre">span</span></code> parameter. For example, to include pre-push (-25% to 0%) and post-recovery (100% to 125%):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts_normalized_on_push_with_span</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">time_normalize</span><span class="p">(</span>
    <span class="n">ts_with_events</span><span class="p">,</span> <span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;recovery&quot;</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ts_normalized_on_push_with_span</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Forces&quot;</span><span class="p">,</span> <span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ts_normalized_on_push_with_span</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Moments&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/93dacad6735fbc15b2adbc5ef2e2a385aee9f169f2f1e36f44619b7902308e64.png" src="_images/93dacad6735fbc15b2adbc5ef2e2a385aee9f169f2f1e36f44619b7902308e64.png" />
</div>
</div>
<p>In this case, each time point still represents 1% of a cycle, but the TimeSeries wrap every 145 points (0 to 19 is the pre-push for the first cycle, 20 to 119 is the first push, 120 to 144 is the post-release for the first cycle, etc.).</p>
</section>
<section id="combining-the-cycles">
<h2>📄 Combining the cycles<a class="headerlink" href="#combining-the-cycles" title="Permalink to this headline">#</a></h2>
<p>Cycles are often analyzed together, and it makes sense to construct a numpy array of higher dimension, where instead of having a first dimension that represents both the cycle and percentage of cycle, we would have a first dimension that represents the cycle, and second that represents the percentage of cycle. This is done using the <a class="reference internal" href="api/ktk.cycles.stack.html"><span class="doc std std-doc">ktk.cycles.stack</span></a> function.</p>
<p>Let’s stack the data from the last computed TimeSeries (without pre-push and post-recovery).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">ts_normalized_on_push</span><span class="p">)</span>

<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
       &#39;Index&#39;: &lt;array of shape (13, 100)&gt;
    &#39;Channels&#39;: &lt;array of shape (13, 100, 6)&gt;
      &#39;Forces&#39;: &lt;array of shape (13, 100, 4)&gt;
     &#39;Moments&#39;: &lt;array of shape (13, 100, 4)&gt;
       &#39;Angle&#39;: &lt;array of shape (13, 100)&gt;
        &#39;Ftot&#39;: &lt;array of shape (13, 100)&gt;
}
</pre></div>
</div>
</div>
</div>
<p>The first dimension of each dictionary’s entry corresponds to the cycles. It now becomes easier to perform operations on cycles. For example, to plot the propulsive moment <code class="docutils literal notranslate"><span class="pre">Mz</span></code> (<code class="docutils literal notranslate"><span class="pre">Moments[2]</span></code>) in each cycle one of top of the other:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot every cycles</span>
<span class="k">for</span> <span class="n">i_cycle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ftot&quot;</span><span class="p">][</span><span class="n">i_cycle</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cycle </span><span class="si">{</span><span class="n">i_cycle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot the average cycle</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ftot&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;k:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Average&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x15b118dc0&gt;
</pre></div>
</div>
<img alt="_images/01eacd187ca8a0d7cdeb9d4afe75357a814bde9cb33f8038b233c79748937964.png" src="_images/01eacd187ca8a0d7cdeb9d4afe75357a814bde9cb33f8038b233c79748937964.png" />
</div>
</div>
</section>
<section id="finding-the-most-repeatable-cycles">
<h2>📄 Finding the most repeatable cycles<a class="headerlink" href="#finding-the-most-repeatable-cycles" title="Permalink to this headline">#</a></h2>
<p>In the previous step, we calculated an average cycle. However, this average cycle was calculated on cycles that were very different between each other. We can use the <a class="reference internal" href="api/ktk.cycles.most_repeatable_cycles.html"><span class="doc std std-doc">ktk.cycles.most_repeatable_cycles</span></a> function to obtain an ordered list from the most repeatable cycles to the most different one. The algorithm is explained in the <a class="reference internal" href="api/ktk.cycles.most_repeatable_cycles.html"><span class="doc std std-doc">API</span></a>. Here, we will base this analysis on the <code class="docutils literal notranslate"><span class="pre">Ftot</span></code> signal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">cycles</span><span class="o">.</span><span class="n">most_repeatable_cycles</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ftot&quot;</span><span class="p">])</span>

<span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[9, 10, 2, 3, 5, 11, 4, 6, 7, 1, 8, 12, 0]
</pre></div>
</div>
</div>
</div>
<p>We see that cycles 12 (last) and 0 (first) were expectedly found as the least repeatable pushes since they are respectively a last push and an acceleration push. Now let’s make the same plot of <code class="docutils literal notranslate"><span class="pre">Mz</span></code>, but based only on the five most repeatable cycles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot every cycles</span>
<span class="k">for</span> <span class="n">i_cycle</span> <span class="ow">in</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ftot&quot;</span><span class="p">][</span><span class="n">i_cycle</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cycle </span><span class="si">{</span><span class="n">i_cycle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot the average cycle</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ftot&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="s2">&quot;k:&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Average&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x15b267490&gt;
</pre></div>
</div>
<img alt="_images/fe4b54df92268dcc417e4b69fd37fdf92a6bb398ccf154f4ea95745a33e7ce11.png" src="_images/fe4b54df92268dcc417e4b69fd37fdf92a6bb398ccf154f4ea95745a33e7ce11.png" />
</div>
</div>
<p>For more information on cycles, please check the <a class="reference internal" href="api/ktk.cycles.html"><span class="doc std std-doc">API Reference for the cycles module</span></a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="filters_median.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">📖 Removing artefacts using a median filter</p>
      </div>
    </a>
    <a class="right-next"
       href="geometry.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">📖 3D rigid body geometry</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-cycles">📄 Detecting cycles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-normalizing-cycles">📄 Time-normalizing cycles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-the-cycles">📄 Combining the cycles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-most-repeatable-cycles">📄 Finding the most repeatable cycles</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Félix Chénier
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2020-2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  This website is built using <a href='https://jupyterbook.org'>jupyter-book</a>.
</div>
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>