
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reconstructing removed markers &mdash; Kinetics Toolkit (dev) master documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Reconstructing probed points" href="03_reconstructing_probed_points.html" />
    <link rel="prev" title="Reconstructing occluded markers" href="01_reconstructing_occluded_markers.html" />


 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
            <a href="../../../index.html">
            <img src="../../../_static/logo_development.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">MANUAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../01_getting_started/00_index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../02_tutorials/00_index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../03_in_depth/00_index.html">In depth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../04_learning_python/00_index.html">Learning Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API REFERENCE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../99_api_reference/01_classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../99_api_reference/02_functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../99_api_reference/03_modules.html">Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LINKS</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://felixchenier.uqam.ca/ktk_develop">Development website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/felixchenier/kineticstoolkit">GitHub repository</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FOR DEVELOPERS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../01_getting_started/00_index.html">Developing Kinetics Toolkit</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../00_index.html">Tutorial development for stable/unstable features</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="00_index.html">Reconstructing markers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01_reconstructing_occluded_markers.html">Reconstructing occluded markers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Reconstructing removed markers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-sample-data">Loading sample data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-cluster-of-markers">Creating a cluster of markers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tracking-the-cluster-to-reconstruct-a-virtual-marker-for-the-epicondyle">Tracking the cluster to reconstruct a “virtual” marker for the epicondyle</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="03_reconstructing_probed_points.html">Reconstructing probed points</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../02_anthropometrics/00_index.html">Anthropometrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_inversedynamics/00_index.html">Inverse Dynamics</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Kinetics Toolkit (dev)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../00_index.html">Tutorial development for stable/unstable features</a> &raquo;</li>
          <li><a href="00_index.html">Reconstructing markers</a> &raquo;</li>
      <li>Reconstructing removed markers</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="01_reconstructing_occluded_markers.html" class="btn btn-neutral float-left" title="Reconstructing occluded markers" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="03_reconstructing_probed_points.html" class="btn btn-neutral float-right" title="Reconstructing probed points" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="reconstructing-removed-markers">
<h1>Reconstructing removed markers<a class="headerlink" href="#reconstructing-removed-markers" title="Permalink to this headline"></a></h1>
<p>Rigid bodies affixed to segments are generally used to reconstruct points where it is not feasible or difficult to put a real marker. The following example represents such a situation, where:</p>
<ul class="simple">
<li><p>With a rigid body of three markers affixed to the left arm, and a single marker affixed to the left lateral elbow epicondyle, an acquisition of a few seconds was recorded with the participant barely moving.</p></li>
<li><p>After removing the elbow epicondyle marker, a wheelchair propulsion acquisition was recorded.</p></li>
<li><p>We want to reconstruct the trajectory of the left lateral elbow epicondyle during the propulsion acquisition, even if it was not present during this acquisition.</p></li>
</ul>
<section id="loading-sample-data">
<h2>Loading sample data<a class="headerlink" href="#loading-sample-data" title="Permalink to this headline"></a></h2>
<p>We will create two TimeSeries, one representing the markers available during the static acquisition, and the other representing the markers available during the propulsion acquisition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">kineticstoolkit.lab</span> <span class="k">as</span> <span class="nn">ktk</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Static acquisition</span>
<span class="n">markers_static</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">kinematics</span><span class="o">.</span><span class="n">read_c3d_file</span><span class="p">(</span>
    <span class="n">ktk</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;kinematics_racing_static.c3d&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">markers_static</span> <span class="o">=</span> <span class="n">markers_static</span><span class="o">.</span><span class="n">get_subset</span><span class="p">([</span>
    <span class="s1">&#39;ArmL1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ArmL2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ArmL3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LateralEpicondyleL&#39;</span><span class="p">,</span>
<span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">markers_static</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">markers_static</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">markers_static</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">markers_static</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;LateralEpicondyleL&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Static acquisition&#39;</span><span class="p">)</span>


<span class="c1"># Propulsion acquisition</span>
<span class="n">markers_propulsion</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">kinematics</span><span class="o">.</span><span class="n">read_c3d_file</span><span class="p">(</span>
    <span class="n">ktk</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;kinematics_racing_propulsion.c3d&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">markers_propulsion</span> <span class="o">=</span> <span class="n">markers_propulsion</span><span class="o">.</span><span class="n">get_subset</span><span class="p">([</span>
    <span class="s1">&#39;ArmL1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ArmL2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ArmL3&#39;</span><span class="p">,</span>
<span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">markers_propulsion</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">markers_propulsion</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">markers_propulsion</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Propulsion acquisition&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0.98, &#39;Propulsion acquisition&#39;)
</pre></div>
</div>
<img alt="../../../_images/02_reconstructing_removed_markers_1_1.png" src="../../../_images/02_reconstructing_removed_markers_1_1.png" />
<img alt="../../../_images/02_reconstructing_removed_markers_1_2.png" src="../../../_images/02_reconstructing_removed_markers_1_2.png" />
</div>
</div>
</section>
<section id="creating-a-cluster-of-markers">
<h2>Creating a cluster of markers<a class="headerlink" href="#creating-a-cluster-of-markers" title="Permalink to this headline"></a></h2>
<p>The idea is very similar to the previous tutorial, where we reconstructed missing markers that belonged to the same rigid body. In this new example, since the lateral elbow epicondyle belongs to the same segment as the rigid body, then we can also include it in the marker cluster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">kinematics</span><span class="o">.</span><span class="n">create_cluster</span><span class="p">(</span>
    <span class="n">markers_static</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;ArmL1&#39;</span><span class="p">,</span> <span class="s1">&#39;ArmL2&#39;</span><span class="p">,</span> <span class="s1">&#39;ArmL3&#39;</span><span class="p">,</span> <span class="s1">&#39;LateralEpicondyleL&#39;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Print the cluster contents</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster</span><span class="p">[</span><span class="s1">&#39;ArmL1&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster</span><span class="p">[</span><span class="s1">&#39;ArmL2&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster</span><span class="p">[</span><span class="s1">&#39;ArmL3&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster</span><span class="p">[</span><span class="s1">&#39;LateralEpicondyleL&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0. -0.  0.  1.]]
[[ 0.0425485 -0.         0.         1.       ]]
[[0.02127445 0.03740441 0.         1.        ]]
[[-0.03848785  0.11239027 -0.02261822  1.        ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="tracking-the-cluster-to-reconstruct-a-virtual-marker-for-the-epicondyle">
<h2>Tracking the cluster to reconstruct a “virtual” marker for the epicondyle<a class="headerlink" href="#tracking-the-cluster-to-reconstruct-a-virtual-marker-for-the-epicondyle" title="Permalink to this headline"></a></h2>
<p>Now, we can use this cluster to reconstruct the whole set of four markers during the propulsion acquisitions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed_markers_propulsion</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">kinematics</span><span class="o">.</span><span class="n">track_cluster</span><span class="p">(</span>
    <span class="n">markers_propulsion</span><span class="p">,</span>
    <span class="n">cluster</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">reconstructed_markers_propulsion</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">reconstructed_markers_propulsion</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">reconstructed_markers_propulsion</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ArmL3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">reconstructed_markers_propulsion</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;LateralEpicondyleL&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/02_reconstructing_removed_markers_5_0.png" src="../../../_images/02_reconstructing_removed_markers_5_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="01_reconstructing_occluded_markers.html" class="btn btn-neutral float-left" title="Reconstructing occluded markers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="03_reconstructing_probed_points.html" class="btn btn-neutral float-right" title="Reconstructing probed points" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2022, Félix Chénier.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>