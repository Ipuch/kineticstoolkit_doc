
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Numpy basics &mdash; Kinetics Toolkit</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="_static/sphinx-thebe.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/stable.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/togglebutton.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
        <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
        <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
        <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
        <script async="async" src="_static/sphinx-thebe.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />


 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
            <a href="index.html">
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started_ktk.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="ktk_in_depth.html">In depth</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="99_api_reference/01_classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="99_api_reference/02_functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="99_api_reference/03_modules.html">Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/felixchenier/kineticstoolkit">GitHub repository</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Numpy basics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/numpy_basics.md" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="numpy-basics">
<h1>Numpy basics<a class="headerlink" href="#numpy-basics" title="Permalink to this headline"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page is a subset from <a class="reference external" href="https://jalammar.github.io/">Jay Alammar</a>’s excellent tutorial: <em>Alammar, J (2019). A Visual Intro to NumPy and Data Representation [Blog post]. Retrieved from <a class="reference external" href="https://jalammar.github.io/visual-numpy/"></a></em></p>
<p><a class="reference external" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<p>This work is licensed under a <a class="reference external" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
<p>Please credit and refer to Jay Alammar’s work for all this page contents.</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="a-visual-intro-to-numpy-and-data-representation">
<h1>A Visual Intro to NumPy and Data Representation<a class="headerlink" href="#a-visual-intro-to-numpy-and-data-representation" title="Permalink to this headline"></a></h1>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image.png" /></p>
<p>The <a class="reference external" href="https://www.numpy.org/">NumPy</a> package is the workhorse of data analysis, machine learning, and scientific computing in the python ecosystem. It vastly simplifies manipulating and crunching vectors and matrices. Some of python’s leading package rely on NumPy as a fundamental piece of their infrastructure (examples include scikit-learn, SciPy, pandas, and tensorflow). Beyond the ability to slice and dice numeric data, mastering numpy will give you an edge when dealing and debugging with advanced usecases in these libraries.</p>
<p>In this post, we’ll look at some of the main ways to use NumPy and how it can represent different types of data (tables, images, text…etc) before we can serve them to machine learning models.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="section" id="creating-arrays">
<h2>Creating Arrays<a class="headerlink" href="#creating-arrays" title="Permalink to this headline"></a></h2>
<p>We can create a NumPy array (a.k.a. the mighty <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html">ndarray</a>) by passing a python list to it and using <code class="docutils literal notranslate"> <span class="pre">np.array()</span></code>. In this case, python creates the array we can see on the right here:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-1.png" /></p>
<p>There are often cases when we want NumPy to initialize the values of the array for us. NumPy provides methods like ones(), zeros(), and random.random() for these cases. We just pass them the number of elements we want it to generate:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-2-1024x228.png" /></p>
<p>Once we’ve created our arrays, we can start to manipulate them in interesting ways.</p>
</div>
<div class="section" id="array-arithmetic">
<h2>Array Arithmetic<a class="headerlink" href="#array-arithmetic" title="Permalink to this headline"></a></h2>
<p>Let’s create two NumPy arrays to showcase their usefulness. We’ll call them <code class="docutils literal notranslate"><span class="pre">data</span></code> and <code class="docutils literal notranslate"><span class="pre">ones</span></code>:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-3.png" /></p>
<p>Adding them up position-wise (i.e. adding the values of each row) is as simple as typing <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">+</span> <span class="pre">ones</span></code>:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-4.png" /></p>
<p>When I started learning such tools, I found it refreshing that an abstraction like this makes me not have to program such a calculation in loops. It’s a wonderful abstraction that allows you to think about problems at a higher level.</p>
<p>And it’s not only addition that we can do this way:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-5-1024x123.png" /></p>
<p>There are often cases when we want to carry out an operation between an array and a single number (we can also call this an operation between a vector and a scalar). Say, for example, our array represents distance in miles, and we want to convert it to kilometers. We simply say <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">*</span> <span class="pre">1.6</span></code>:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-6-1024x116.png" /></p>
<p>See how NumPy understood that operation to mean that the multiplication should happen with each cell? That concept is called <em>broadcasting</em>, and it’s very useful.</p>
</div>
<div class="section" id="indexing">
<h2>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline"></a></h2>
<p>We can index and slice NumPy arrays in all the ways we can slice python lists:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-7.png" /></p>
</div>
<div class="section" id="aggregation">
<h2>Aggregation<a class="headerlink" href="#aggregation" title="Permalink to this headline"></a></h2>
<p>Additional benefits NumPy gives us are aggregation functions:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-8-1024x185.png" /></p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, and <code class="docutils literal notranslate"><span class="pre">sum</span></code>, you get all the greats like <code class="docutils literal notranslate"><span class="pre">mean</span></code> to get the average, <code class="docutils literal notranslate"><span class="pre">prod</span></code> to get the result of multiplying all the elements together, <code class="docutils literal notranslate"><span class="pre">std</span></code> to get standard deviation, and <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/02.04-computation-on-arrays-aggregates.html">plenty of others</a>.</p>
</div>
<div class="section" id="in-more-dimensions">
<h2>In more dimensions<a class="headerlink" href="#in-more-dimensions" title="Permalink to this headline"></a></h2>
<p>All the examples we’ve looked at deal with vectors in one dimension. A key part of the beauty of NumPy is its ability to apply everything we’ve looked at so far to any number of dimensions.</p>
<div class="section" id="creating-matrices">
<h3>Creating Matrices<a class="headerlink" href="#creating-matrices" title="Permalink to this headline"></a></h3>
<p>We can pass python lists of lists in the following shape to have NumPy create a matrix to represent them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-9.png" /></p>
<p>We can also use the same methods we mentioned above (<code class="docutils literal notranslate"><span class="pre">ones()</span></code>, <code class="docutils literal notranslate"><span class="pre">zeros()</span></code>, and <code class="docutils literal notranslate"><span class="pre">random.random()</span></code>) as long as we give them a tuple describing the dimensions of the matrix we are creating:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-10-1024x184.png" /></p>
</div>
<div class="section" id="matrix-arithmetic">
<h3>Matrix Arithmetic<a class="headerlink" href="#matrix-arithmetic" title="Permalink to this headline"></a></h3>
<p>We can add and multiply matrices using arithmetic operators (<code class="docutils literal notranslate"><span class="pre">+-*/</span></code>) if the two matrices are the same size. NumPy handles those as position-wise operations:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-11.png" /></p>
<p>We can get away with doing these arithmetic operations on matrices of different size only if the different dimension is one (e.g. the matrix has only one column or one row), in which case NumPy uses its broadcast rules for that operation:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-12-1024x186.png" /></p>
</div>
<div class="section" id="dot-product">
<h3>Dot Product<a class="headerlink" href="#dot-product" title="Permalink to this headline"></a></h3>
<p>A key distinction to make with arithmetic is the case of <a class="reference external" href="https://www.mathsisfun.com/algebra/matrix-multiplying.html">matrix multiplication</a> using the dot product. NumPy gives every matrix a <code class="docutils literal notranslate"><span class="pre">dot()</span></code> method we can use to carry-out dot product operations with other matrices:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-13-1024x256.png" /></p>
<p>I’ve added matrix dimensions at the bottom of this figure to stress that the two matrices have to have the same dimension on the side they face each other with. You can visualize this operation as looking like this:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-14-1024x252.png" /></p>
</div>
<div class="section" id="matrix-indexing">
<h3>Matrix Indexing<a class="headerlink" href="#matrix-indexing" title="Permalink to this headline"></a></h3>
<p>Indexing and slicing operations become even more useful when we’re manipulating matrices:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-15.png" /></p>
</div>
<div class="section" id="matrix-aggregation">
<h3>Matrix Aggregation<a class="headerlink" href="#matrix-aggregation" title="Permalink to this headline"></a></h3>
<p>We can aggregate matrices the same way we aggregated vectors:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-16-1024x197.png" /></p>
<p>Not only can we aggregate all the values in a matrix, but we can also aggregate across the rows or columns by using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-17-1024x183.png" /></p>
</div>
</div>
<div class="section" id="transposing-and-reshaping">
<h2>Transposing and Reshaping<a class="headerlink" href="#transposing-and-reshaping" title="Permalink to this headline"></a></h2>
<p>A common need when dealing with matrices is the need to rotate them. This is often the case when we need to take the dot product of two matrices and need to align the dimension they share. NumPy arrays have a convenient property called <code class="docutils literal notranslate"><span class="pre">T</span></code> to get the transpose of a matrix:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-18.png" /></p>
<p>In more advanced use case, you may find yourself needing to switch the dimensions of a certain matrix. This is often the case in machine learning applications where a certain model expects a certain shape for the inputs that is different from your dataset. NumPy’s <code class="docutils literal notranslate"><span class="pre">reshape()</span></code> method is useful in these cases. You just pass it the new dimensions you want for the matrix. You can pass -1 for a dimension and NumPy can infer the correct dimension based on your matrix:</p>
<p><img alt="" src="https://felixchenier.uqam.ca/wp-content/uploads/2021/02/image-19-1024x379.png" /></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>